}
data$lag=lagpad(data$start,1)
data$tdif=as.numeric(difftime(strptime(data$start,"%m/%d/%Y %H:%M"),strptime(data$lag,"%m/%d/%Y %H:%M")))
data$tdif[is.na(data$tdif)]<- 0
data$cumsumT=cumsum(data$tdif)
length(which(complete.cases(data[,3])))
nrow(data)
setwd("Mplus")
classes=read.table('na_2.txt',header=F)
class=classes[,c(length(classes)-((max(classes[,length(classes)]))+1),length(classes))]
colnames(class)<-c('row','class')
data$row=seq(1,nrow(data),1)
data=merge(data,class,by='row',all=T)
data$class1=ifelse(data$class==1,1,0)
data$class2=ifelse(data$class==2,1,0)
options(width=90)
data$start
dati=data
library(DataCombine)
new <- rep(NA, length(dati))
dati <- InsertRow(dati, NewRow=new, RowNum = 88)
dati$start
dati$day <- rep(1:7, each=4, length.out=nrow(dati))
dati$mon=ifelse(dati$day==7,1,0)
dati$tues=ifelse(dati$day==1,1,0)
dati$wed=ifelse(dati$day==2,1,0)
dati$thur=ifelse(dati$day==3,1,0)
dati$fri=ifelse(dati$day==4,1,0)
dati$sat=ifelse(dati$day==5,1,0)
dati$sun=ifelse(dati$day==6,1,0)
dati$ping=seq(0,3,1)
dati$morning=ifelse(dati$ping==0,1,0)
dati$midday=ifelse(dati$ping==1,1,0)
dati$eve=ifelse(dati$ping==2,1,0)
dati$night=ifelse(dati$ping==3,1,0)
datx=dati
datx$linear=scale(datx$cumsumT)
datx$quad=datx$linear^2
datx$cub=datx$linear^3
datx$cosT=cos(((2*pi)/24)*datx$cumsumT)
datx$sinT=sin(((2*pi)/24)*datx$cumsumT)
datx$cos2T=cos(((2*pi)/12)*datx$cumsumT)
datx$sin2T=sin(((2*pi)/12)*datx$cumsumT)
datx$cosW=cos(((2*pi)/168)*datx$cumsumT)
datx$sinW=sin(((2*pi)/168)*datx$cumsumT)
options(width=159)#desktop
options(width=120)#laptop
describe(datx)
nrow(datx)
datx$filter=ifelse(!complete.cases(datx[,c(4:25)]),1,0)
daty=subset(datx,filter==0)
row.names(daty)<- NULL
nrow(daty)
even=seq(0,nrow(daty)-1,1)
plot(daty$class1~even,type='o')
plot(daty$class2~even,type='o')
describe(daty)
mat=as.matrix(daty[,c(38:43,46:57)])
set.seed(101010)
mlcl1=cv.glmnet(mat,daty$class1,family='binomial',standardize=T,alpha=.5)
coefcl1=coef(mlcl1, s = "lambda.min")
coefcl1
lmcl1=glm(class1~tues+thur+fri+sat+sun+eve+quad+linear+cub+sinT+cosT+cosW+sinW,daty,family=binomial,na.action=na.exclude)
summary(lmcl1)
set.seed(101010)
mlcl1=cv.glmnet(mat,daty$class1,family='binomial',standardize=T,alpha=.5)
coefcl1=coef(mlcl1, s = "lambda.min")
coefcl1
lmcl1=glm(class1~tues+thur+fri+sat+sun+eve+quad+linear+cub+sinT+cosT+cosW+sinW,daty,family=binomial,na.action=na.exclude)
summary(lmcl1)
somers2(predict(lmcl1),daty$class1)[1]
NagelkerkeR2(lmcl1)
mlpredcl1=predict.cv.glmnet(mlcl1, newx=mat, s = "lambda.min", type = "link")
daty$netpredcl1=as.numeric(mlpredcl1)
somers2(daty$netpredcl1,daty$class1)[1]
mlr2cl1=glm(class1~netpredcl1,daty,family=binomial)
NagelkerkeR2(mlr2cl1)
setwd("C:/Users/Hannah/Box Sync/Research (bosley@berkeley.edu)/Projects/LCA/P244")
save(list = ls(all.names = TRUE), file = "workspace.RData", envir = .GlobalEnv)
library("ggplot2")
setwd("C:/Users/Hannah/Box Sync/Research (bosley@berkeley.edu)/Projects/LCA")
data = read.csv("predictor counts_updated_11.1.csv")
counts = data.frame(Predictor=names(data)[4:20], Freq=rep(0, 17))
rm(list=ls())
library("ggplot2")
setwd("C:/Users/Hannah/Box Sync/Research (bosley@berkeley.edu)/Projects/LCA")
data = read.csv("counts_updated_11.1.csv")
counts = data.frame(Predictor=names(data)[4:20], Freq=rep(0, 17))
for (i in 1:nrow(counts)){
counts$Freq[i] = sum(data[,(i+3)], na.rm=TRUE)
counts$Percent[i] = round((sum(data[,(i+3)], na.rm=TRUE)/97)*100, 2)
}
fix(counts)
for (i in 1:nrow(counts)){
counts$Freq[i] = sum(data[,(i+3)], na.rm=TRUE)
counts$Percent[i] = round((sum(data[,(i+3)], na.rm=TRUE)/97)*100, 2)
}
ggplot(counts, aes(x = reorder(Predictor, -Freq), y = Freq)) +
geom_bar(stat = "identity") +
geom_text(aes(label=paste0(Percent,"%"),
y=Percent+0.75), size=4) +
labs(title="Frequency of Retained Predictors",
x ="Predictor", y = "Count") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
dat=read.csv('rev.csv')
summary(lm(avgbrier~gad,dat))
summary(lm(avgbrier~hamd,dat))
summary(lm(avgbrier~hama,dat))
summary(lm(avgbrier~hama+hamd,dat))
summary(lm(avgbrier~sex+age+hama+hamd,dat))
save.image("C:/Users/Aaron Fisher/Dropbox/Lab/GAD_MDD_Trial/BRAT Special Issue/LCA/between_subjects.RData")
dat=read.csv('rev.csv')
summary(lm(avgbrier~sex+age+hama+hamd,dat))
summary(lm(avgbrier~strat,dat))
summary(lm(avgbrier~anger,dat))
hist(data$avgbrier)
hist(dat$avgbrier)
hist(dat$avgauc)
View(dat)
dat=read.csv('rev.csv')
source('C:/Users/Aaron Fisher/Dropbox/Lab/GAD_MDD_Trial/BRAT Special Issue/Analyses/between_subjects.R', echo=TRUE)
hist(dat$avgauc)
summary(lm(avgbrier~anger+strat,dat))
summary(lm(avgauc~anger,dat))
summary(lm(lowbrier~anger,dat))
summary(lm(acutebrier~anger,dat))
summary(lm(avgbrier~anger+gad,dat))
summary(lm(avgbrier~anger+hama+hamd,dat))
View(dat)
summary(lm(avgbrier~classes,dat))
summary(lm(avgbrier~classes+anger,dat))
summary(lm(avgbrier~anger,dat))
pdf('avgauc.pdf')
plot(hist(dat$avgauc),xlab='Area Under the Curve',ylab='Frequency',title='')
dev.off()
pdf('avgauc.pdf')
hist(dat$avgauc,xlab='Area Under the Curve',ylab='Frequency',title='')
dev.off()
pdf('avgauc.pdf')
hist(dat$avgauc,xlab='Area Under the Curve',ylab='Frequency',main='')
dev.off()
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(-.2,.9), ylim=c(0,22), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.main=1.75,cex.axis=1.5,cex.lab=2)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.main=1.75,cex.axis=1.5,cex.lab=2)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1.5,cex.lab=2)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=2)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
pdf('avgauc.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
dev.off()
mean(dat$avgauc)
mean(dat$avgauc,na.rm=T)
sd(dat$avgauc,na.rm=T) #.77
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .77", "SD = .10"))
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .77", "SD = .10"),cex=1)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .77", "SD = .10"),cex=.75)
pdf('avgauc.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .77", "SD = .10"),cex=.75)
dev.off()
pdf('avgauc.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .77", "SD = .10"),cex=.85)
dev.off()
#Brier
hist(dat$avgbrier,xlab='Brier Score',ylab='Frequency',main='')
mean(dat$avgbrier,na.rm=T) #.77
sd(dat$avgbrier,na.rm=T) #.10
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,8), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=12,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=11,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
pdf('avgauc.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
dev.off()
dev.off()
dev.off()
pdf('avgbrier.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
dev.off()
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
#Brier
hist(dat$avgbrier,xlab='Brier Score',ylab='Frequency',main='')
pdf('avgbrier.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .17", "SD = .04"),cex=.85)
dev.off()
mean(dat$avgbrier,na.rm=T) #.17
sd(dat$avgbrier,na.rm=T) #.04
pdf('avgbrier.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
dev.off()
hist(dat$avgbrier, col=rgb(1,0,0,0.5),format(xlim=c(.1,.25),decimals=3), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
#AUC
hist(dat$acuteauc,xlab='Area Under the Curve',ylab='Frequency',main='')
mean(dat$acuteauc,na.rm=T) #.77
sd(dat$acuteauc,na.rm=T) #.10
hist(dat$acuteauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,10), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acuteauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .82", "SD = .11"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acuteauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,12), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acuteauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .82", "SD = .11"),cex=.85)
pdf('acuteauc.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acuteauc, col=rgb(1,0,0,0.5),xlim=c(.5,1), ylim=c(0,12), main='',
xlab='Area Under the Curve',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acuteauc,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .82", "SD = .11"),cex=.85)
dev.off()
#Brier
hist(dat$acutebrier,xlab='Brier Score',ylab='Frequency',main='')
mean(dat$acutebrier,na.rm=T) #.172
sd(dat$acutebrier,na.rm=T) #.036
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.1,.3), ylim=c(0,15), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.1,.3), ylim=c(0,10), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.0,.3), ylim=c(0,10), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.0,.3), ylim=c(0,10), main='',
xlab='Brier Score',ylab='Frequency',breaks=8,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.0,.3), ylim=c(0,10), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.02,.3), ylim=c(0,10), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.05,.3), ylim=c(0,10), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.04,.3), ylim=c(0,10), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
pdf('acutebrier.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$acutebrier, col=rgb(1,0,0,0.5),xlim=c(.04,.3), ylim=c(0,10), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$acutebrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .150", "SD = .055"),cex=.85)
dev.off()
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.1,.25), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.0,.3), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.075,.255), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.9,.255), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.09,.255), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.095,.255), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
pdf('avgbrier.pdf')
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.095,.255), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=10,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
dev.off()
par(mar=c(5.1,4.6,4.1,3))
hist(dat$avgbrier, col=rgb(1,0,0,0.5),xlim=c(.095,.255), ylim=c(0,9), main='',
xlab='Brier Score',ylab='Frequency',breaks=12,cex.axis=1,cex.lab=1.5)
box()
abline(v = mean(dat$avgbrier,na.rm=TRUE), col = rgb(1,0,0,1), lwd = 2)
legend(x = "topright",c("Mean = .172", "SD = .036"),cex=.85)
#summary(lm(avgauc~anger,dat))
summary(lm(highauc~anger,dat))
#summary(lm(avgauc~anger,dat))
summary(lm(bestauc~anger,dat))
summary(lm(avgbrier~anger*gad,dat))
summary(lm(avgbrier~anger+gad,dat))
summary(glm(anger~hama+hamd,family=binomial))
summary(glm(anger~hama+hamd,dat,family=binomial))
summary(glm(anger~hama,dat,family=binomial))
summary(glm(anger~hamd,datfamily=binomial))
summary(glm(anger~hamd,dat,family=binomial))
summary(glm(anger~gad,dat,family=binomial))
summary(glm(anger~sex,dat,family=binomial))
summary(glm(anger~strat,dat,family=binomial))
summary(glm(anger~.,dat,family=binomial))
summary(glm(anger~gad,dat,family=binomial))
summary(glm(anger~gad+strat,dat,family=binomial))
load("C:/Users/Aaron Fisher/Dropbox/Lab/GAD_MDD_Trial/BRAT Special Issue/Analyses/Between Subject Revision/between_subjects.RData")
#dat=read.csv('rev.csv')
dat=read.csv('revii.csv')
View(dat)
#dat=read.csv('rev.csv')
dat=read.csv('revii.csv')
View(dat)
library(glmnet)
library(psych)
describe(dat)
getOption(max.print=9999)
getOption('max.print'=9999)
getOptions(max.print=9999)
options(max.print=1000000)
describe(dat)
mat1=data.matrix(dat[,25:54])
mat2=data.matrix(dat[,25:31,55:77])
mat1=data.matrix(dat[,25:54,78:100])
mat1=data.matrix(dat[,25:31,55:77,101:123])
mat1=data.matrix(dat[,25:54])
mat2=data.matrix(dat[,c(25:31,55:77)])
mat1=data.matrix(dat[,c(25:54,78:100)])
mat1=data.matrix(dat[,c(25:31,55:77,101:123)])
mat1=data.matrix(dat[,25:54])
mat2=data.matrix(dat[,c(25:31,55:77)])
mat3=data.matrix(dat[,c(25:54,78:100)])
mat4=data.matrix(dat[,c(25:31,55:77,101:123)])
set.seed(1234)
m1=cv.glmnet(mat1,dat$avgbrier,family='gaussian',standardize=T,alpha=.5)
mat1=data.matrix(dat[,25:51,53,54])
mat2=data.matrix(dat[,c(25:31,55:74,76,77)])
mat3=data.matrix(dat[,c(25:51,53,54,78:97,99,100)])
mat4=data.matrix(dat[,c(25:31,55:74,76,77,101:120,122,123)])
set.seed(1234)
m1=cv.glmnet(mat1,dat$avgbrier,family='gaussian',standardize=T,alpha=.5)
dat$avgbrier
mat1
mat1=data.matrix(dat[,25:51,53,54])
mat1=data.matrix(dat[,c(25:51,53,54)])
mat2=data.matrix(dat[,c(25:31,55:74,76,77)])
mat3=data.matrix(dat[,c(25:51,53,54,78:97,99,100)])
mat4=data.matrix(dat[,c(25:31,55:74,76,77,101:120,122,123)])
set.seed(1234)
m1=cv.glmnet(mat1,dat$avgbrier,family='gaussian',standardize=T,alpha=.5)
c1=coef(m1, s = "lambda.min")
c1
m2=cv.glmnet(mat2,dat$avgbrier,family='gaussian',standardize=T,alpha=.5)
c2=coef(m2, s = "lambda.min")
c2
set.seed(1234)
m3=cv.glmnet(mat3,dat$avgbrier,family='gaussian',standardize=T,alpha=.5)
c3=coef(m3, s = "lambda.min")
c3
set.seed(1234)
m4=cv.glmnet(mat4,dat$avgbrier,family='gaussian',standardize=T,alpha=.5)
c4=coef(m4, s = "lambda.min")
c4
set.seed(1234)
m1=cv.glmnet(mat1,dat$avgauc,family='gaussian',standardize=T,alpha=.5)
c1=coef(m1, s = "lambda.min")
c1
set.seed(1234)
m2=cv.glmnet(mat2,dat$avgauc,family='gaussian',standardize=T,alpha=.5)
c2=coef(m2, s = "lambda.min")
c2
set.seed(1234)
m3=cv.glmnet(mat3,dat$avgauc,family='gaussian',standardize=T,alpha=.5)
c3=coef(m3, s = "lambda.min")
c3
set.seed(1234)
m4=cv.glmnet(mat4,dat$avgauc,family='gaussian',standardize=T,alpha=.5)
c4=coef(m4, s = "lambda.min")
c4
